import org.apache.tools.ant.filters.ReplaceTokens
plugins {
    id "java"
    id 'com.github.johnrengelman.shadow' version "6.0.0"
}

group 'io.ib67.oni'
String version= '1.0-SNAPSHOT'

repositories {
    mavenCentral()
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.12'
}
task buildOni {
    replaceText(new File("${project.rootDir}/src/main/java/io/ib67/oni/Oni.java"),"VERSION",version)
}
shadowJar.dependsOn(buildOni)
def static replaceText(File file, String key, String value) {
    def fileText = file.text
    def regex = '@' + key + '@'
    fileText = (fileText =~ /${regex}/).replaceAll(value)
    file.write(fileText)
}
